function closeMdCustomMenu(){const e=document.getElementById("md-custom-menu"),t=e.querySelector("div.dropdown-menu");t&&(t.style.transform=`translate3d(0, ${t.clientHeight}px, 0)`,e.classList.add("md-cmenu-transparent"),setTimeout(()=>{for(e.classList.add("md-cmenu-hide");e.firstChild;)e.removeChild(e.firstChild);e.click()},150))}(()=>{const t=(e,t,n,o)=>new Promise((i,c)=>{const d="beforeend",s=document.createElement("div");s.id="confirm",document.body.insertAdjacentElement(d,s);const r=document.createElement("div");r.id="confirm-contents",s.insertAdjacentElement(d,r);const m=document.createElement("div");m.id="confirm-title",m.textContent=e,r.insertAdjacentElement(d,m);const a=document.createElement("div");a.id="confirm-message",a.textContent=t,r.insertAdjacentElement(d,a);const l=document.createElement("div");l.id="confirm-footer",r.insertAdjacentElement(d,l);const u=document.createElement("div");u.id="confirm-cancel",u.textContent=o||"Cancel",l.insertAdjacentElement(d,u);const p=document.createElement("div");p.id="confirm-ok",p.textContent=n||"OK",l.insertAdjacentElement(d,p);const f=document.createElement("style");f.id="confirm-style",f.insertAdjacentHTML(d,"body,html{overflow:hidden!important}#confirm,#confirm *{-webkit-tap-highlight-color:transparent;user-select:none;box-sizing:border-box;margin:0;padding:0;color:inherit}#confirm{position:fixed;z-index:10000;inset:0;display:flex;font-size:16px;text-align:left;background-color:rgba(0,0,0,.5);color:rgba(0,0,0,.87)}#confirm-contents{width:80%;max-width:768px;margin:auto;border-radius:2px;background-color:#fafafa}#confirm-contents>*{margin:15px}#confirm-footer{margin:4px 6px;text-align:right}#confirm-cancel,#confirm-ok{display:inline-block;vertical-align:middle;height:36px;margin:6px 0;padding:0 16px;font-size:14px;line-height:36px;color:#343434;cursor:pointer}"),s.insertAdjacentElement(d,f);const g=()=>{s.remove()};s.addEventListener("click",e=>{e.target!==s||g()}),u.addEventListener("click",()=>{if(g(),c)return c()}),p.addEventListener("click",()=>{if(g(),i)return i()})}),n={embed:'<svg viewBox="0 0 24 24"><g><path d="M23.804 11.5l-6.496-7.25c-.278-.31-.752-.334-1.06-.06-.308.277-.334.752-.058 1.06L22.238 12l-6.047 6.75c-.275.308-.25.782.06 1.06.142.127.32.19.5.19.204 0 .41-.084.558-.25l6.496-7.25c.252-.28.258-.713 0-1zm-23.606 0l6.496-7.25c.278-.31.752-.334 1.06-.06.308.277.334.752.058 1.06L1.764 12l6.047 6.75c.277.308.25.782-.057 1.06-.143.127-.322.19-.5.19-.206 0-.41-.084-.56-.25L.197 12.5c-.252-.28-.257-.713 0-1zm9.872 12c-.045 0-.09-.004-.135-.012-.407-.073-.68-.463-.605-.87l3.863-21.5c.074-.407.466-.674.87-.606.408.073.68.463.606.87l-3.864 21.5c-.065.363-.38.618-.737.618z"></path></g></svg>'},o={"reference-to":"copylink","message-to":"message",email:"message",mention:"mention",followOrUnfollow:"follow",favoriteOrUnfavorite:"favorite",message:"message",lists:"addList",customtimelines:"addCollection","search-for-quoted":"search",destroy:"remove","flag-media":"report",mute:"mute",muteConversation:"mute",block:"block","report-tweet":"report","report-spam":"report"};if(!document.getElementById("md-style-menu")){const e=document.createElement("style");e.id="md-style-menu",e.type="text/css",e.innerHTML='html,body{overflow:hidden!important}#md-custom-menu .caret{display:none}#md-custom-menu{display:block;position:fixed;top:0;left:0;z-index:999;width:100vw;height:100vh;background-color:#00000060;will-change:background-color;transition-property:background-color;transition-duration:.15s;user-select:none}#md-custom-menu.md-cmenu-transparent{background-color:#0000}#md-custom-menu.md-cmenu-hide{height:0}.dropdown-menu.md-cmenu-hide{display:none!important}#md-custom-menu>.dropdown-menu{display:block!important;position:absolute!important;top:unset!important;bottom:0!important;left:0!important;right:unset!important;margin:0!important;width:100%;border-radius:15px 15px 0 0!important;box-shadow:0 0 7px 0 rgb(0 0 0 / 13%)!important;font-size:14px!important;will-change:transform;transition:.15s cubic-bezier(.4,0,.2,1)}#md-custom-menu .md-drag{transition:0s!important}#md-custom-menu>.dropdown-menu>.md-menu-handle{display:block;width:30px;height:4px;border-radius:2px;margin:0 calc((100vw - 30px)/ 2) 5px;background-color:currentcolor}#md-custom-menu>.dropdown-menu li.is-selectable{position:relative;height:35px}#md-custom-menu>.dropdown-menu li>.md-cmenu-icon,#md-custom-menu>.dropdown-menu li>svg{display:inline-block;position:absolute;top:0;left:20px;width:auto;height:21px;line-height:21px;padding:7px 0;box-sizing:content-box!important;color:currentcolor;fill:currentcolor}#md-custom-menu>.dropdown-menu li>a{display:inline-block;width:100%;height:100%;line-height:35px;padding:0 25px 0 50px}#md-custom-menu .md-cmenu-dummy{position:absolute;top:0;left:0;width:100%;height:100%}#md-custom-menu .md-cmenu-dummy:hover{background-color:#00000015}#md-custom-menu>.dropdown-menu li.is-selectable>a:after{font-size:14px!important}#md-custom-menu .icon:before{font-weight:400}.md-icon-mention:before{content:"\\F064"}.md-icon-copylink:before{content:"\\F098"}.md-icon-message:before{content:"\\F054"}.md-icon-follow:before{content:"\\F175"}.md-icon-favorite:before{content:"\\F148"}.md-icon-addList:before{content:"\\F712"}.md-icon-addCollection{transform:scale(-1,1)}.md-icon-addCollection:before{content:"\\F214"}.md-icon-search:before{content:"\\F058"}.md-icon-mute:before{content:"\\F101"}.md-icon-block:before{content:"\\E609"}.md-icon-report:before{content:"\\F038"}.md-icon-remove:before{content:"\\F154"}',document.head.appendChild(e)}if(!document.getElementById("md-custom-menu")){const e=document.createElement("div");e.id="md-custom-menu",e.classList.add("md-cmenu-hide","md-cmenu-transparent"),e.addEventListener("touchstart",function(e){c=e.target,d=c.closest("div.dropdown-menu"),r=c.closest("a[data-action]");const t=e.touches;m||(m={x:t[0].pageX,y:t[0].pageY});a||(a=m);p=0}),e.addEventListener("touchmove",function(e){if(!d)return;const t=e.touches;if(a={x:t[0].pageX,y:t[0].pageY},!f)return d.classList.add("md-drag"),(p=a.y-m.y-5)<0&&(p=0),g=p>130,void(d.style.transform=`translate3d(0, ${p}px, 0)`);f&&20<function(e,t){const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);return n*n+o*o}(m,a)&&(f=!1)}),e.addEventListener("touchend",function(e){if(c=null,m=null,a=null,f=!0,!d)return void closeMdCustomMenu();d.classList.remove("md-drag"),g?(d.style.transform=`translate3d(0, ${d.innerHeight}px, 0)`,closeMdCustomMenu()):d.style.transform="translate3d(0, 0, 0)";g=!1}),document.body.appendChild(e)}function i(e){const t=document.body.querySelector("div:not(#md-custom-menu) .dropdown-menu");if(!t||!e)return;const n=t.querySelector(`a[data-action="${e}"]`),o=n?n.closest("li.is-selectable"):null;o&&(o.classList.add("is-selected"),n.click())}let c,d,r,m,a,l=null;function u(e){e.classList.add("md-cmenu-hide");const c=document.getElementById("md-custom-menu");!l&&c.classList.contains("md-cmenu-hide")&&(l=setTimeout(()=>{v.disconnect();const d=e.cloneNode(!0);if(c){c.classList.remove("md-cmenu-hide","md-cmenu-transparent"),d.insertAdjacentHTML("afterbegin",'<div class="md-menu-handle"></div>');const e=d.querySelectorAll("li.is-selectable > a[data-action]");for(s of e){const e=s.dataset.action;if(e){if(o[e]){const t=`<div class="md-cmenu-icon"><i class="icon md-icon-${o[e]}"></i></div>`;s.insertAdjacentHTML("beforebegin",t)}else n[e]&&s.insertAdjacentHTML("beforebegin",n[e]);const c=document.createElement("div");c.classList.add("md-cmenu-dummy"),c.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),"destroy"==e?t("削除","このツイートを削除しますか?","はい","いいえ").then(()=>{i("destroy")}).catch(()=>{}):i(e)},{passive:!1}),s.parentNode.insertBefore(c,s.nextSibling)}}d.style.transform=`translate3d(0, ${window.innerHeight}px, 0)`,c.appendChild(d),d.style.transform=`translate3d(0, ${d.clientHeight}px, 0)`,d.style.transform="translate3d(0, 0, 0)"}v.observe(h,b),l&&clearTimeout(l),l=null},10))}let p=0,f=!0,g=!1;const h=document.body,b={childList:!0,subtree:!0},v=new MutationObserver(t=>{for(e of(v.disconnect(),t)){const t=e.addedNodes,n=t?t[0]:null;if(n&&n.classList&&n.classList.contains("dropdown-menu"))n.closest('a[data-action="message-menu"], nav.app-navigator, div.js-column-options')||u(n);else{const t=e.removedNodes,n=t?t[0]:null;n&&n.classList&&n.classList.contains("dropdown-menu")&&closeMdCustomMenu()}}v.observe(h,b)});h&&v.observe(h,b)})();
